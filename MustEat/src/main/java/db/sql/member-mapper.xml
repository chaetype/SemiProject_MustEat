<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
	
	<!-- 태민 (로그인관련) -->
	<entry key="loginMember">
		SELECT		
		      MEM_NO
			, MEM_ID
			, MEM_PWD
			, MEM_NAME
			, MEM_PHONE
			, MEM_EMAIL
			, MEM_ENROLLDATE
			, MEM_MODIFYDATE
			, MEM_STATUS
			, MEM_NICKNAME
			, MEM_GRADE
			, ADDRESS_CODE
			, ADDRESS
			, ADDRESS_DETAIL
			, ADDRESS_REF
			, MEM_IMGPATH
			, WITHDRAW
		FROM MEMBER
		WHERE (MEM_STATUS = 'Y' 
		   OR MEM_STATUS = 'A')
		  AND MEM_ID = ?
		  AND MEM_PWD = ?
	</entry>
	
	

	<!-- 태민 (아이디 찾기) -->
	<entry key="findId">
	SELECT
		  RPAD(SUBSTR(MEM_ID,1,3), LENGTH(MEM_ID), '*') AS"SECREAT_ID"
		, MEM_ID
		, MEM_EMAIL
	  FROM
	  	  MEMBER
     WHERE MEM_NAME = ?
	   AND MEM_EMAIL = ?
		
	</entry>
	
	<!-- 태민 (비밀번호 찾기) -->
	<entry key="findPwd">
		SELECT
			  MEM_PWD
			, MEM_EMAIL
		  FROM
		  	  MEMBER
		 WHERE MEM_ID = ?
		   AND MEM_EMAIL = ?
		
	</entry>
	
	
	<!-- 은영 (회원 정보 수정) -->
	<entry key="updateMember">
	<!-- 회원정보 수정 요청시 실행할 sql문 -->
		UPDATE MEMBER
	    SET MEM_PWD = ? 
	      , MEM_NAME = ?
	      , MEM_PHONE = ?
	      , MEM_EMAIL = ?
	      , MEM_NICKNAME = ?
	      , ADDRESS_CODE = ?
	      , ADDRESS = ?
	      , ADDRESS_DETAIL = ?
	      , ADDRESS_REF = ?
		WHERE MEM_ID = ?
	</entry>
	
	<!-- 은영 (수정된 회원 정보 조회) -->
	<entry key="selectUpdateMember">
	<!-- 수정된 회원정보 조회시 실행할 sql문 -->
		SELECT
			MEM_ID
		  , MEM_PWD
		  , MEM_NAME
		  , MEM_PHONE
		  , MEM_EMAIL
		  , MEM_NICKNAME
		  , ADDRESS_CODE
		  , ADDRESS
		  , ADDRESS_DETAIL
		  , ADDRESS_REF
		FROM MEMBER
		WHERE MEM_ID = ?
	</entry>

	
	

	<!-- 채윤 : 신고글 -->
	<entry key="selectReportList">
		SELECT 
		       REPORT_NO
		     , REM.MEM_NICKNAME
		     , SRM.MEM_ID
		     , SR.REVIEW_TITLE
		     , REPORT_CONTENT
             , REPORT_DATE
		  FROM REPORT RE
		  JOIN MEMBER REM ON (RE.MEM_NO = REM.MEM_NO)
          JOIN STORE_RE SR ON (RE.RE_NO = SR.RE_NO)
          JOIN MEMBER SRM ON (SR.REVIEW_WRITER = SRM.MEM_NO)
		 ORDER 
		    BY REPORT_NO DESC
	</entry>
	
	<!-- 은영 (회원 탈퇴 처리) -->
	<entry key="deleteMember">
	<!-- 회원 탈퇴 신청시 실행할 sql문 -->
		UPDATE MEMBER
		    SET MEM_STATUS = 'N'
		      , WITHDRAW = ?
		WHERE MEM_ID = ?
	  	  AND MEM_PWD = ?
	</entry>
	
	<!-- 은영(마이페이지 게시판 조회) -->
	<entry key="selectMyPage">
	<!-- 마이페이지에서 리뷰,적립금,가고싶다,팔로우 조회시 실행할 sql문 -->
		SELECT 
		    M.MEM_ID, <!-- 1. 로그인한 회원 아이디 -->
		    (SELECT COUNT(REVIEW_WRITER) 
		            FROM STORE_RE S 
		    WHERE M.MEM_NO = S.REVIEW_WRITER) AS STORE_REVIEW, <!-- 2. 식당 리뷰 갯수 -->
		    (SELECT COUNT(REVIEW_WRITER) 
		            FROM PRODUCT_REVIEW P 
		    WHERE M.MEM_NO = P.REVIEW_WRITER) AS PRODUCT_REVIEW, <!-- 3. 밀키트 리뷰 갯수 -->
		    (SELECT SUM(MPS_RECORD) 
		            FROM MPS_POINT MP 
		    WHERE M.MEM_NO = MP.MEM_NO) AS MPS_POINT, <!-- 4. 적립금 총 금액 -->
		    (SELECT COUNT(MEM_NO) 
		            FROM STORE_SCRAP SS 
		    WHERE M.MEM_NO = SS.MEM_NO) AS STORE_SCRAP, <!-- 5. 식당 스크랩 갯수 -->
		    (SELECT COUNT(FING_MNO) 
		            FROM FOLLOW F 
		    WHERE M.MEM_NO = F.F_MNO) AS FOLLOW <!-- 6. 팔로우한 인원 수 -->
		FROM MEMBER M
		WHERE MEM_ID = ? <!-- 로그인한 회원 아이디 -->
	</entry>
	
	<!-- 은영 (마이페이지에서 적립금 내역 중 최신 2개 조회) -->
	<entry key="selectNewPoint">
		SELECT ROWNUM, A.* 
		    FROM (
		            SELECT MEM_ID
		                 , MPS_CATEGORY
		                 , MPS_RECORD
		                 , MPS_STATUS
		                 , SU_DATE
		            FROM MPS_POINT
		            JOIN MEMBER USING (MEM_NO)
		            WHERE MEM_ID = ? <!-- 로그인한 회원 아이디 -->
		            ORDER BY SU_DATE DESC
		        )A
		WHERE ROWNUM BETWEEN 1 AND 2
	</entry>
	
	<!-- 은영 (마이페이지 가고싶다 스크랩 중 최신 2개 조회) -->
	<entry key="selectNewScrap">
		SELECT ROWNUM, A.*
		    FROM (
		        SELECT 
		            (SELECT STORE_NAME <!-- 식당이름 -->
		                FROM STORE S 
		                WHERE SC.STORE_NO = S.STORE_NO) AS STORE_NAME,
		            (SELECT STORE_ADDRESS <!-- 식당주소 -->
		                FROM STORE S
		                WHERE SC.STORE_NO = S.STORE_NO) AS STORE_ADDRESS,
		            (SELECT AVG(REVIEW_RATE) <!-- 식당 평균 -->
		                FROM STORE_RE SR
		                WHERE SR.STORE_NO = SC.STORE_NO) AS RATE
		        FROM STORE_SCRAP SC
		        JOIN MEMBER USING (MEM_NO)
		        WHERE MEM_ID = ? <!-- 로그인한 회원 아이디 -->
		        ORDER BY SCRAP_DATE DESC
		        ) A
		WHERE ROWNUM BETWEEN 1 AND 2
	</entry>


	<!-- 채윤 나의 팔로우 목록 조회 -->
	<entry key="myFollowList">
	
	</entry>
	
	
</properties>
